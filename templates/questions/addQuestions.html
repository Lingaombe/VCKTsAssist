{% extends 'poyambira.html' %}

{% block header %}
    <h1 class="h2">Add Questions</h1>
    <a href="/addQuestionBank">Create New Question Bank</a>
{% endblock %}

{% block content %}
<!-- Quill Editor with KaTeX support -->
<link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">
<script src="https://cdn.quilljs.com/1.3.6/quill.js"></script>
<script src="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.css">

<style>
  .ql-container { font-size: 14px; }
  .ql-editor { min-height: 300px; }
  .ql-toolbar { border: 1px solid #ccc; border-bottom: none; }
  .ql-container { border: 1px solid #ccc; }
</style>

<div>
    <form action="/submitQuestion" method="POST" class="quesForm" enctype="multipart/form-data">
        <label for="questionBank">questionBank:</label>
        <select id="questionBank" name="questionBank" required>
            <option value="">Select questionBank</option>
            {% for questionBank in QuestionBanks %}
                <option value="{{ questionBank.questionBankID }}">{{ questionBank.questionBankName }} {{questionBank.courseID}} {{questionBank.questionBankType}}</option>
            {% endfor %}
        </select>
        <br><br>

        <label for="questionText">Enter question:</label><br>
        <p style="font-size: 12px; color: #666;">Use the formula button (Î£) for LaTeX math. Use subscript/superscript buttons for H<sub>2</sub>O, E=mc<sup>2</sup>, etc.</p>
        <div id="questionText" style="background-color: white; border: 1px solid #ccc;"></div>
        <textarea id="questionText" name="questionText" style="display: none;"></textarea>
        <br><br>
        <label for="difficulty">Difficulty level A (easy), B, C:</label><br>
        <input class="input-control" name="difficulty" id="difficulty" type="text" pattern="[a-cA-C]+" required title="Only A-C allowed" placeholder="Enter difficulty">
        <br><br>
        <label for="unit">Enter Unit:</label><br>
        <input name="unit" id="unit" type="text" pattern="[0-9]+" required title="Only numbers" placeholder="Enter unit">
        <br><br>
        <label for="marks">Allotted marks:</label><br>
        <input name="marks" id="marks" type="text" pattern="[0-9]+" required title="Only numbers allowed" placeholder="Enter marks">
        <br><br>

        <label for="photo">Upload Question Image/Photo (optional):</label><br>
        <input type="file" id="photo" name="photo" accept="image/*,.pdf" style="margin: 10px 0;">
        <br><br>

        <button class="btn btn-primary" type="submit">Add Question</button>
        <br>
    </form>
</div>

<style>
  #questionText {
    width: 100%;
    max-width: 1200px;
  }
  .ql-toolbar { border: 1px solid #ccc; border-bottom: none; }
  .ql-container { border: 1px solid #ccc; }
</style>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    Quill.register('modules/formula', true);
    const quill = new Quill('#questionText', {
      theme: 'snow',
      modules: {
        toolbar: [
          ['bold', 'italic', 'underline'],
          [{ 'script': 'sub'}, { 'script': 'super' }],
          ['blockquote', 'code-block'],
          [{ 'list': 'ordered'}, { 'list': 'bullet' }],
          ['link'],
          ['formula']
        ]
      }
    });
    
//     // On form submit, copy editor content to hidden field
//     document.querySelector('.quesForm').addEventListener('submit', function() {
//     //   document.querySelector('textarea[name="questionText"]').value = quill.root.innerHTML;
//       document.querySelector("[name='questionText']").value = "default text";
//     });
});
</script>

{% endblock %}
